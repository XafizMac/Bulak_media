import {
  View,
  Text,
  StyleSheet,
  ScrollView,
  FlatList,
  Dimensions,
  Button,
} from "react-native";
import React, { useEffect, useLayoutEffect, useRef, useState } from "react";
import { JavshanItem } from "../JavshanItem";
import Svg, { Path } from "react-native-svg";

export const Bab = React.memo(({ route }) => {
  const { page } = route.params;
  const [currentPage, setCurrentPage] = useState(page);
  const babItem = JavshanItem.find((item) => item.id === currentPage);
  const flatListRef = useRef(null);

  const scrollToItem = () => {
    flatListRef.current?.scrollToIndex({ index: currentPage - 1 });
  };
  useLayoutEffect(() => {
    setTimeout(scrollToItem, 1)
    console.log("scrollToItem");
  }, [currentPage])


  const Monogram = (direc) => {
    return (
      <>
        {direc === "top" ? (
          <Svg width="100%" height="50" viewBox="0 0 597 108" fill="none" xmlns="http://www.w3.org/2000/svg">
            <Path d="M292.467 5.66699C289.801 8.60032 287.667 11.8003 287.667 12.867C287.667 13.9337 285.667 14.867 282.334 15.4003C279.534 15.8003 275.134 17.5337 272.734 19.1337L268.334 22.3337L277.667 23.1337C287.934 23.9337 291.534 25.4003 295.401 30.3337L298.067 33.667L301.934 29.8003C305.534 26.2003 315.267 23.0003 322.601 23.0003C324.867 23.0003 325.134 22.7337 323.534 20.867C321.134 17.9337 315.001 15.0003 311.001 15.0003C309.134 15.0003 307.667 14.2003 307.667 13.267C307.667 11.0003 300.067 0.333657 298.467 0.333657C297.801 0.333657 295.134 2.73366 292.467 5.66699Z" fill="#F2BB4A" />
            <Path d="M266.735 29.667C263.001 31.9337 262.335 33.0003 262.335 37.5337C262.335 43.0003 265.001 46.467 268.335 45.1337C271.001 44.2003 270.868 38.467 268.201 36.2003C266.201 34.6003 266.335 34.2003 269.001 32.067C272.868 28.867 279.801 29.0003 286.335 32.3337C297.801 38.2003 299.001 53.4003 288.735 62.467C272.201 77.4003 241.668 82.467 206.068 76.467C182.601 72.3337 140.868 62.2003 139.535 60.2003C137.801 57.4003 138.068 48.7337 140.201 43.9337C145.001 32.2003 162.601 27.0003 171.401 34.6003C175.935 38.6003 176.335 42.467 172.468 46.3337C168.201 50.6003 163.135 50.6003 158.868 46.3337C155.268 42.6003 154.335 42.3337 154.335 44.467C154.335 47.267 162.068 53.667 165.668 53.667C174.868 53.667 181.535 45.267 178.335 37.667C175.535 30.867 171.001 28.3337 161.801 28.3337C152.068 28.3337 143.935 31.667 139.935 37.267C136.601 42.067 133.935 53.0003 135.001 57.5337C135.801 60.6003 135.668 60.7337 130.068 59.8003C126.868 59.267 119.001 57.9337 112.335 56.867C105.801 55.8003 87.4014 54.467 71.5347 54.067C47.4014 53.4003 41.2681 53.667 32.7347 55.5337C9.26807 60.7337 -4.9986 77.4003 1.8014 91.667C4.2014 96.7337 11.9347 101.534 17.6681 101.667C21.9347 101.667 28.6014 96.867 29.5347 93.0003C30.7347 88.467 27.2681 82.7337 24.2014 83.9337C22.4681 84.6003 22.2014 86.067 22.7347 90.467C23.4014 96.7337 22.4681 97.667 15.5347 97.667C13.1347 97.667 10.3347 96.467 8.33473 94.467C-4.9986 81.1337 12.4681 62.6003 41.6681 58.867C57.0014 57.0003 96.0681 59.1337 119.668 63.1337C136.201 65.9337 136.335 65.9337 141.935 71.8003C160.068 90.6003 203.801 97.0003 246.068 87.0003C268.468 81.667 288.868 71.267 294.735 62.2003C296.335 59.667 297.935 57.667 298.335 57.8003C298.735 57.8003 300.601 60.067 302.468 62.7337C309.401 72.867 327.801 81.667 355.001 88.067C375.001 92.7337 406.735 93.0003 422.601 88.6003C436.868 84.7337 447.001 79.4003 454.201 72.2003L460.335 65.9337L477.535 63.0003C511.401 57.267 557.001 57.267 571.801 62.867C587.001 68.6003 595.535 80.2003 591.668 89.667C589.668 94.3337 584.335 97.667 578.468 97.667C573.401 97.667 572.735 96.467 574.601 91.267C576.601 86.067 574.201 82.3337 570.201 84.467C568.335 85.4003 567.668 87.267 567.668 91.0003C567.668 97.0003 570.868 99.9337 578.468 101.134C588.201 102.734 598.068 91.0003 596.335 80.2003C594.468 69.1337 578.735 58.067 560.335 54.867C546.868 52.6003 499.401 54.2003 479.668 57.5337C471.268 59.1337 463.535 60.3337 462.735 60.3337C461.535 60.3337 461.001 57.9337 461.001 52.6003C461.001 46.3337 460.201 43.667 457.135 38.867C452.468 31.4003 446.468 28.3337 436.335 28.3337C424.735 28.3337 417.001 33.667 417.001 41.9337C417.001 51.1337 429.935 56.867 437.401 51.0003C439.401 49.4003 441.001 47.0003 441.001 45.667C441.001 43.4003 440.601 43.4003 437.668 46.3337C435.935 48.2003 432.868 49.667 431.001 49.667C427.268 49.667 421.001 44.3337 421.001 41.1337C421.001 40.067 422.468 37.4003 424.201 35.4003C427.135 32.067 428.201 31.667 436.201 31.667C445.535 31.667 449.535 33.667 454.868 40.7337C457.668 44.6003 459.268 57.1337 457.268 60.067C455.801 62.2003 407.135 73.8003 386.468 77.1337C342.335 84.067 301.001 69.8003 301.001 47.5337C301.001 33.667 319.801 24.3337 330.068 33.1337C330.335 33.267 329.268 34.7337 327.668 36.3337C323.801 40.2003 324.601 45.0003 329.001 45.0003C331.668 45.0003 332.468 44.067 333.535 39.8003C334.601 34.867 334.468 34.3337 330.468 30.7337C322.868 23.9337 308.601 26.2003 300.735 35.4003L298.335 38.3337L295.535 35.0003C290.468 29.0003 286.068 27.0003 278.335 27.0003C273.401 27.0003 269.668 27.8003 266.735 29.667ZM163.135 72.2003C188.335 78.3337 204.468 81.4003 221.668 83.267C235.801 84.7337 237.001 85.0003 231.668 85.9337C228.335 86.3337 217.535 86.867 207.401 86.867C181.135 87.0003 164.201 83.267 151.401 74.6003C145.401 70.6003 143.535 68.3337 146.201 68.3337C146.735 68.3337 154.468 70.067 163.135 72.2003ZM447.668 72.467C436.335 82.3337 423.535 85.8003 395.668 86.6003C384.335 86.867 371.668 86.6003 367.668 85.9337L360.335 84.6003L366.201 84.467C376.601 84.2003 398.468 80.3337 423.668 74.467C437.268 71.267 449.268 68.6003 450.335 68.6003C451.401 68.467 450.335 70.2003 447.668 72.467Z" fill="#F2BB4A" />
            <Path d="M137.401 29.6666C132.067 30.8666 127.267 33.9333 124.201 38.0666C121.934 40.9999 121.667 41.1333 116.201 39.1333C111.534 37.3999 110.201 37.3999 108.467 38.8666C106.067 40.8666 105.667 45.1333 107.667 46.3333C110.734 48.1999 108.601 49.3999 101.001 50.3333C91.2672 51.3999 85.4005 49.5333 84.2005 44.7333C83.0005 40.1999 87.1338 35.9333 91.6672 36.8666C95.0005 37.5333 95.0005 37.5333 91.9338 36.0666C88.0672 34.0666 82.8672 36.3333 80.7338 40.8666C79.5338 43.5333 79.6672 44.8666 81.5338 47.5333C84.4672 52.1999 92.3338 54.0666 104.734 52.9999C112.867 52.3333 116.601 52.5999 123.134 54.7333L131.134 57.2666L130.601 53.5333C129.667 47.5333 133.001 40.1999 139.267 34.0666C145.267 28.1999 145.134 27.7999 137.401 29.6666Z" fill="#F2BB4A" />
            <Path d="M455.933 32.8667C462.067 38.4667 465.267 44.8667 465.533 51.2667C465.667 57 465.8 57.1334 475 54.2C479.933 52.7334 484.333 52.3334 491.933 53C509.4 54.4667 517.4 50.3334 515.133 41C514.067 36.7334 508.333 34.2 504.067 36.2C502.333 37 501 38.2 501 39C501 39.9334 501.933 39.5334 503.133 38.4667C505.8 35.6667 507.133 35.8 510.333 39C513.933 42.6 513.667 44.8667 509.4 48.3334C506.067 50.8667 504.6 51.1334 497.133 50.4667C487.533 49.6667 486.6 49.1334 488.867 46.4667C491.133 43.6667 489.4 39.1334 485.667 38.2C484.067 37.8 480.867 38.3334 478.733 39.4C475 41.4 474.733 41.4 471.267 37C468.733 33.8 465.533 31.8 460.733 30.3334C451 27.5334 450.333 27.8 455.933 32.8667Z" fill="#F2BB4A" />
            <Path d="M67.6673 102.333C66.8673 103.4 66.4673 104.867 67.0007 105.667C68.0673 107.4 72.6007 107.4 73.6673 105.667C74.2007 104.733 150.601 104.333 298.334 104.333C446.067 104.333 522.467 104.733 523.001 105.667C524.601 108.2 529.001 107.133 529.001 104.333C529.001 101.267 524.867 98.8666 523.934 101.4C523.267 103.533 73.0007 103.667 73.0007 101.667C73.0007 99.6666 69.534 100.067 67.6673 102.333Z" fill="#F2BB4A" />
          </Svg>
        ) : (
          <Svg width="100%" height="80" viewBox="0 0 657 92" fill="none" xmlns="http://www.w3.org/2000/svg">
            <Path d="M97.3324 2.01668C94.9324 4.81668 99.0657 9.35002 101.599 6.81668C103.599 4.81668 550.799 4.41668 554.666 6.55002C558.399 8.55002 561.199 4.55002 558.266 1.61668C556.266 -0.383318 555.866 -0.383318 553.599 1.61668C551.332 3.75002 535.199 3.88335 327.732 3.88335C130.799 3.88335 104.132 3.61668 102.666 1.88335C100.532 -0.649985 99.4657 -0.649985 97.3324 2.01668Z" fill="#F2BB4A" />
            <Path d="M4.40008 19.0839C-0.133256 22.9505 1.06674 24.8172 6.66674 22.5505C9.06674 21.4839 10.6667 19.8839 10.6667 18.4172C10.6667 15.0839 8.93341 15.2172 4.40008 19.0839Z" fill="#F2BB4A" />
            <Path d="M104.667 17.8839C94.8 20.0172 87.0667 23.0839 76.6667 28.9506C62.9333 36.6839 46.2667 44.6839 38.6667 47.2172C22.8 52.4172 8.93333 49.2172 2.93333 38.6839C0.8 35.0839 0 34.5506 0 36.5506C0 40.9506 7.46667 48.8172 14 51.3506C27.0667 56.2839 44.4 51.4839 76.6667 33.6172C86.2667 28.4172 95.8667 23.6172 98 23.2172L102 22.2839L97.0667 26.4172C88 34.1506 87.8667 46.9506 96.9333 52.2839C102.933 55.7506 114.533 56.6839 118 54.1506C120.533 52.1506 120.533 52.0172 118.267 51.0839C116.8 50.5506 113.867 51.0839 111.2 52.4172C106.8 54.4172 106.267 54.4172 101.333 51.8839C88.1333 45.0839 91.3333 31.4839 107.733 24.9506C122.4 19.2172 153.2 21.6172 176.4 30.4172L180.133 31.8839L176 35.3506C162.933 46.4172 163.333 65.2172 176.8 72.8172C185.333 77.7506 195.467 76.0172 201.6 68.6839C205.067 64.5506 204.667 56.9506 200.933 53.4839C196.267 49.0839 189.333 49.8839 189.333 54.6839C189.333 57.7506 192.4 58.0172 195.067 55.2172C196.8 53.6172 197.333 53.6172 199.2 55.7506C202.4 59.3506 201.867 64.2839 197.733 68.1506C185.2 80.0172 166.267 67.0839 170.8 50.0172C172.533 43.8839 181.067 34.5506 184.933 34.5506C186.4 34.5506 198.933 39.2172 212.8 45.0839C226.667 50.8172 241.867 56.8172 246.667 58.2839C272.8 66.8172 296.133 69.0839 309.733 64.2839C316.8 61.7506 326.667 53.4839 326.667 49.8839C326.667 46.4172 328.533 47.6172 331.333 52.8172C336.667 62.6839 346 66.5506 364.933 66.5506C386 66.5506 405.067 61.2172 445.2 44.2839C458 38.9506 469.467 34.5506 470.8 34.5506C474.8 34.5506 482.267 42.1506 484.8 48.6839C486.667 53.6172 486.8 55.4839 485.467 59.8839C483.867 65.2172 478.133 70.6839 472.267 72.5506C461.733 75.7506 450.4 63.6172 456.4 55.3506C458 53.2172 458.267 53.2172 459.867 55.0839C462.4 58.0172 466.667 57.8839 466.667 54.6839C466.667 52.4172 463.333 50.5506 459.067 50.5506C455.6 50.5506 452 55.7506 452 60.8172C452 66.6839 454.8 70.6839 460.933 73.7506C473.733 80.1506 489.867 69.7506 489.6 55.2172C489.6 48.4172 486.933 42.8172 480.8 36.6839L476.267 32.1506L479.6 30.6839C481.467 29.7506 488.533 27.7506 495.2 26.0172C525.333 18.1506 552.533 21.3506 560 33.6172C564.933 41.4839 562.8 48.2839 554.133 52.4172C549.867 54.4172 549.2 54.4172 544.933 52.4172C540.133 50.1506 534.4 50.8172 536.933 53.3506C541.6 58.0172 556.533 55.3506 561.867 49.0839C567.467 42.4172 566.4 34.2839 558.8 26.1506L555.333 22.2839L562.4 24.9506C566.267 26.4172 575.333 30.9506 582.4 35.0839C605.867 48.4172 618.8 53.2172 631.333 53.2172C643.333 53.0839 653.867 46.1506 655.467 37.2172L656.133 32.5506L653.733 37.4839C648.933 47.2172 638.933 51.2172 624.667 48.9506C614.533 47.3506 604.667 43.2172 585.733 32.5506C565.867 21.3506 553.867 17.2172 538 16.2839C523.867 15.4839 501.467 18.9506 482.533 25.0839C471.067 28.8172 470.4 28.8172 464.267 26.9506C455.467 24.2839 438.133 25.4839 425.2 29.7506C419.6 31.6172 407.333 36.8172 397.867 41.2172C367.067 55.8839 353.733 58.8172 341.733 53.3506C336.533 50.9506 332 45.2172 332 41.0839C332 37.3506 337.6 28.2839 341.2 26.1506C348.4 21.8839 357.333 24.6839 357.333 31.2172C357.333 32.9506 356 35.3506 354.4 36.4172C352.8 37.6172 352.133 38.5506 353.067 38.5506C355.467 38.5506 360 33.4839 360 30.8172C360 26.6839 356 22.6839 350.533 21.2172C345.867 19.8839 344.4 20.1506 339.333 22.5506C335.867 24.1506 332.267 27.3506 330.533 30.0172L327.733 34.6839L325.467 30.4172C322.267 23.8839 317.067 20.8172 310 20.8172C298.933 20.8172 292.267 29.4839 298.533 35.7506C300.133 37.3506 302.133 38.5506 302.933 38.5506C303.867 38.5506 303.2 37.6172 301.6 36.4172C297.867 33.7506 297.867 28.6839 301.6 26.0172C308.133 21.3506 317.067 25.0839 321.467 34.2839C324 39.4839 324.133 40.4172 322.4 44.9506C318.4 55.4839 304 58.6839 285.867 53.0839C280.8 51.4839 268.667 46.4172 258.8 41.6172C227.467 26.5506 210.4 22.6839 193.467 27.0839L185.067 29.2172L170.4 24.5506C145.733 16.5506 121.733 14.1506 104.667 17.8839ZM216.8 29.3506C227.6 31.2172 233.333 33.3506 257.333 44.5506C268.667 49.8839 281.333 55.3506 285.333 56.6839C293.867 59.4839 308.533 59.8839 313.067 57.3506C314.8 56.4172 316.533 56.0172 316.933 56.4172C317.467 56.8172 314.8 58.4172 311.333 60.0172C293.467 67.8839 268.667 63.3506 218.267 43.0839C204.133 37.4839 192.133 32.4172 191.467 31.7506C190.267 30.6839 199.333 28.2839 205.467 28.0172C207.333 27.8839 212.4 28.5506 216.8 29.3506ZM462.4 30.4172C464.4 31.6172 464.4 31.7506 462 32.6839C460.533 33.2172 450.933 37.2172 440.667 41.6172C392.933 62.0172 370.933 66.9506 351.333 61.7506C339.867 58.8172 340 57.7506 351.467 58.2839C364.8 58.9506 369.733 57.6172 396.533 45.3506C428.667 30.5506 438.8 27.6172 452.4 28.5506C456.667 28.9506 461.2 29.7506 462.4 30.4172Z" fill="#F2BB4A" />
            <Path d="M645.334 18.4164C645.334 21.0831 652.667 24.9498 654.401 23.2164C655.467 22.2831 648.667 15.8831 646.534 15.8831C645.867 15.8831 645.334 16.9498 645.334 18.4164Z" fill="#F2BB4A" />
            <Path d="M324.266 61.2168C320.266 66.4168 310.933 70.5501 299.866 72.4168C294.799 73.2168 290.666 74.2835 290.666 74.8168C290.666 76.2835 298.533 80.1501 303.733 81.3501C305.999 81.8835 310.266 81.7501 312.933 81.2168C317.466 80.1501 318.133 80.4168 322.933 85.6168L327.999 91.2168L333.066 85.6168C337.999 80.2835 338.399 80.1501 343.466 81.2168C346.266 81.8835 350.133 82.0168 351.999 81.6168C356.799 80.5501 365.333 76.0168 365.333 74.6835C365.333 74.0168 361.866 73.0835 357.733 72.5501C346.399 71.2168 336.799 67.0835 332.133 61.8835C329.866 59.3501 327.866 57.2168 327.733 57.3501C327.466 57.3501 325.999 59.0835 324.266 61.2168Z" fill="#F2BB4A" />
          </Svg>
        )}
      </>
    )
  }
  const BabCard = ({ item, index }) => {
    return (
      <View key={index} style={styles.container}>
        <ScrollView showsVerticalScrollIndicator={false} style={{ width: "100%", height: "100%" }}>
          <View style={styles.card}>
            {Monogram("top")}
            {babItem.firstText ? (
              <Text style={styles.subtitle}>{item.firstText}</Text>
            ) : null}
            <Text style={styles.text}>{item.javshantext}</Text>
            <Text style={styles.endText}>{item.secondText}</Text>
            {Monogram("bottom")}
            <Text style={styles.title}>{item.id}</Text>
          </View>
        </ScrollView>
      </View>
    );
  }

  return (
    <View style={styles.main}>
      <FlatList
        ref={flatListRef}
        pagingEnabled
        contentContainerStyle={{ height: Dimensions.get('screen').height - 150 }}
        showsHorizontalScrollIndicator={false}
        horizontal
        data={JavshanItem}
        getItemLayout={(data, index) => (
          { length: Dimensions.get('screen').width, offset: Dimensions.get('screen').width * index, index }
        )}
        onScrollToIndexFailed={(info) => {
          const wait = new Promise(resolve => setTimeout(resolve, 50));
          wait.then(() => {
            flatListRef.current?.scrollToIndex({ index: info.index, animated: false });
          });
        }}
        renderItem={({ item, index }) => <BabCard item={item} index={index} />}
      />
    </View>
  );
});

const styles = StyleSheet.create({
  main: {
    width: "100%",
    height: "100%",
    backgroundColor: "#2E0A30",
  },
  container: {
    width: Dimensions.get('screen').width,
    paddingHorizontal: 12,
    // paddingTop: 20,
    flex: 1,
    height: "100%",
    justifyContent: "center",
  },
  card: {
    width: "100%",
    height: "100%",
    display: "flex",
    flexDirection: "column",
    justifyContent: "space-between",
    alignItems: "center",
    alignSelf: "center"
  },
  title: {
    fontFamily: "Bold",
    fontSize: 25,
    color: "#F2BB4A",
    textAlign: "center",
  },
  subtitle: {
    fontFamily: "Bold",
    fontSize: 18,
    color: "white",
    textAlign: "center",
  },
  text: {
    fontSize: 18,
    lineHeight: 25,
    fontFamily: "Medium",
    color: "white",
    textAlign: "center"
  },
  endText: {
    color: "#F2BB4A",
    fontSize: 18,
    fontFamily: "Bold",
    marginTop: 12,
    textAlign: "center"
  }
});
